select
	m.match_id ,
	s.step_number,
    p.roleindex,
    p.goal_value,
	IF(LOCATE('CONTROL BLACK',state) > 0, 1, -1),
	IF(LOCATE('CONTROL WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 1 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 2 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 3 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 4 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 5 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 6 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 7 8 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 1 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 1 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 2 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 2 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 3 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 3 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 4 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 4 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 5 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 5 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 6 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 6 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 7 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 7 WHITE',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 8 BLACK',state) > 0, 1, -1),
	IF(LOCATE('CELLHOLDS 8 8 WHITE',state) > 0, 1, -1),
	locate('NOOP', move),
	locate('(MOVE 1 2 1 1)', move),
	locate('(MOVE 1 2 2 1)', move),
	locate('(MOVE 1 3 1 2)', move),
	locate('(MOVE 1 3 2 2)', move),
	locate('(MOVE 1 4 1 3)', move),
	locate('(MOVE 1 4 2 3)', move),
	locate('(MOVE 1 5 1 4)', move),
	locate('(MOVE 1 5 2 4)', move),
	locate('(MOVE 1 6 1 5)', move),
	locate('(MOVE 1 6 2 5)', move),
	locate('(MOVE 1 7 1 6)', move),
	locate('(MOVE 1 7 2 6)', move),
	locate('(MOVE 1 8 1 7)', move),
	locate('(MOVE 1 8 2 7)', move),
	locate('(MOVE 2 2 1 1)', move),
	locate('(MOVE 2 2 2 1)', move),
	locate('(MOVE 2 2 3 1)', move),
	locate('(MOVE 2 3 1 2)', move),
	locate('(MOVE 2 3 2 2)', move),
	locate('(MOVE 2 3 3 2)', move),
	locate('(MOVE 2 4 1 3)', move),
	locate('(MOVE 2 4 2 3)', move),
	locate('(MOVE 2 4 3 3)', move),
	locate('(MOVE 2 5 1 4)', move),
	locate('(MOVE 2 5 2 4)', move),
	locate('(MOVE 2 5 3 4)', move),
	locate('(MOVE 2 6 1 5)', move),
	locate('(MOVE 2 6 2 5)', move),
	locate('(MOVE 2 6 3 5)', move),
	locate('(MOVE 2 7 1 6)', move),
	locate('(MOVE 2 7 2 6)', move),
	locate('(MOVE 2 7 3 6)', move),
	locate('(MOVE 2 8 1 7)', move),
	locate('(MOVE 2 8 2 7)', move),
	locate('(MOVE 2 8 3 7)', move),
	locate('(MOVE 3 2 2 1)', move),
	locate('(MOVE 3 2 3 1)', move),
	locate('(MOVE 3 2 4 1)', move),
	locate('(MOVE 3 3 2 2)', move),
	locate('(MOVE 3 3 3 2)', move),
	locate('(MOVE 3 3 4 2)', move),
	locate('(MOVE 3 4 2 3)', move),
	locate('(MOVE 3 4 3 3)', move),
	locate('(MOVE 3 4 4 3)', move),
	locate('(MOVE 3 5 2 4)', move),
	locate('(MOVE 3 5 3 4)', move),
	locate('(MOVE 3 5 4 4)', move),
	locate('(MOVE 3 6 2 5)', move),
	locate('(MOVE 3 6 3 5)', move),
	locate('(MOVE 3 6 4 5)', move),
	locate('(MOVE 3 7 2 6)', move),
	locate('(MOVE 3 7 3 6)', move),
	locate('(MOVE 3 7 4 6)', move),
	locate('(MOVE 3 8 2 7)', move),
	locate('(MOVE 3 8 3 7)', move),
	locate('(MOVE 3 8 4 7)', move),
	locate('(MOVE 4 2 3 1)', move),
	locate('(MOVE 4 2 4 1)', move),
	locate('(MOVE 4 2 5 1)', move),
	locate('(MOVE 4 3 3 2)', move),
	locate('(MOVE 4 3 4 2)', move),
	locate('(MOVE 4 3 5 2)', move),
	locate('(MOVE 4 4 3 3)', move),
	locate('(MOVE 4 4 4 3)', move),
	locate('(MOVE 4 4 5 3)', move),
	locate('(MOVE 4 5 3 4)', move),
	locate('(MOVE 4 5 4 4)', move),
	locate('(MOVE 4 5 5 4)', move),
	locate('(MOVE 4 6 3 5)', move),
	locate('(MOVE 4 6 4 5)', move),
	locate('(MOVE 4 6 5 5)', move),
	locate('(MOVE 4 7 3 6)', move),
	locate('(MOVE 4 7 4 6)', move),
	locate('(MOVE 4 7 5 6)', move),
	locate('(MOVE 4 8 3 7)', move),
	locate('(MOVE 4 8 4 7)', move),
	locate('(MOVE 4 8 5 7)', move),
	locate('(MOVE 5 2 4 1)', move),
	locate('(MOVE 5 2 5 1)', move),
	locate('(MOVE 5 2 6 1)', move),
	locate('(MOVE 5 3 4 2)', move),
	locate('(MOVE 5 3 5 2)', move),
	locate('(MOVE 5 3 6 2)', move),
	locate('(MOVE 5 4 4 3)', move),
	locate('(MOVE 5 4 5 3)', move),
	locate('(MOVE 5 4 6 3)', move),
	locate('(MOVE 5 5 4 4)', move),
	locate('(MOVE 5 5 5 4)', move),
	locate('(MOVE 5 5 6 4)', move),
	locate('(MOVE 5 6 4 5)', move),
	locate('(MOVE 5 6 5 5)', move),
	locate('(MOVE 5 6 6 5)', move),
	locate('(MOVE 5 7 4 6)', move),
	locate('(MOVE 5 7 5 6)', move),
	locate('(MOVE 5 7 6 6)', move),
	locate('(MOVE 5 8 4 7)', move),
	locate('(MOVE 5 8 5 7)', move),
	locate('(MOVE 5 8 6 7)', move),
	locate('(MOVE 6 2 5 1)', move),
	locate('(MOVE 6 2 6 1)', move),
	locate('(MOVE 6 2 7 1)', move),
	locate('(MOVE 6 3 5 2)', move),
	locate('(MOVE 6 3 6 2)', move),
	locate('(MOVE 6 3 7 2)', move),
	locate('(MOVE 6 4 5 3)', move),
	locate('(MOVE 6 4 6 3)', move),
	locate('(MOVE 6 4 7 3)', move),
	locate('(MOVE 6 5 5 4)', move),
	locate('(MOVE 6 5 6 4)', move),
	locate('(MOVE 6 5 7 4)', move),
	locate('(MOVE 6 6 5 5)', move),
	locate('(MOVE 6 6 6 5)', move),
	locate('(MOVE 6 6 7 5)', move),
	locate('(MOVE 6 7 5 6)', move),
	locate('(MOVE 6 7 6 6)', move),
	locate('(MOVE 6 7 7 6)', move),
	locate('(MOVE 6 8 5 7)', move),
	locate('(MOVE 6 8 6 7)', move),
	locate('(MOVE 6 8 7 7)', move),
	locate('(MOVE 7 2 6 1)', move),
	locate('(MOVE 7 2 7 1)', move),
	locate('(MOVE 7 2 8 1)', move),
	locate('(MOVE 7 3 6 2)', move),
	locate('(MOVE 7 3 7 2)', move),
	locate('(MOVE 7 3 8 2)', move),
	locate('(MOVE 7 4 6 3)', move),
	locate('(MOVE 7 4 7 3)', move),
	locate('(MOVE 7 4 8 3)', move),
	locate('(MOVE 7 5 6 4)', move),
	locate('(MOVE 7 5 7 4)', move),
	locate('(MOVE 7 5 8 4)', move),
	locate('(MOVE 7 6 6 5)', move),
	locate('(MOVE 7 6 7 5)', move),
	locate('(MOVE 7 6 8 5)', move),
	locate('(MOVE 7 7 6 6)', move),
	locate('(MOVE 7 7 7 6)', move),
	locate('(MOVE 7 7 8 6)', move),
	locate('(MOVE 7 8 6 7)', move),
	locate('(MOVE 7 8 7 7)', move),
	locate('(MOVE 7 8 8 7)', move),
	locate('(MOVE 8 2 7 1)', move),
	locate('(MOVE 8 2 8 1)', move),
	locate('(MOVE 8 3 7 2)', move),
	locate('(MOVE 8 3 8 2)', move),
	locate('(MOVE 8 4 7 3)', move),
	locate('(MOVE 8 4 8 3)', move),
	locate('(MOVE 8 5 7 4)', move),
	locate('(MOVE 8 5 8 4)', move),
	locate('(MOVE 8 6 7 5)', move),
	locate('(MOVE 8 6 8 5)', move),
	locate('(MOVE 8 7 7 6)', move),
	locate('(MOVE 8 7 8 6)', move),
	locate('(MOVE 8 8 7 7)', move),
	locate('(MOVE 8 8 8 7)', move)
FROM 
    states s, 
    matches m, 
    match_players p,
    moves mo
where 
    m.match_id = s.match_id and
    p.match_id = m.match_id and
    p.match_id = m.match_id and
    p.roleindex = mo.roleindex and
    mo.roleindex = p.roleindex and
    mo.match_id = m.match_id and
    mo.step_number = s.step_number and

    m.game = 'breakthrough' and 
    p.player != 'Random' and
    mo.move != 'NOOP' and
    p.roleindex = 1

INTO OUTFILE 'breakthrough_role1.csv'
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n';