drop table states_parsed;
create table states_parsed(
	game varchar(40),
	match_id varchar(40),
    step_number int(11),
	CONTROLRED int,
	CONTROLWHITE int,
	CELL10DIRT int,
	CELL11B int, CELL11R int, CELL11W int,
	CELL12B int, CELL12R int, CELL12W int,
	CELL13B int, CELL13R int, CELL13W int,
	CELL14B int, CELL14R int, CELL14W int,
	CELL15B int, CELL15R int, CELL15W int,
	CELL16B int, CELL16R int, CELL16W int,
	CELL20DIRT int,
	CELL21B int, CELL21R int, CELL21W int,
	CELL22B int, CELL22R int, CELL22W int,
	CELL23B int, CELL23R int, CELL23W int,
	CELL24B int, CELL24R int, CELL24W int,
	CELL25B int, CELL25R int, CELL25W int,
	CELL26B int, CELL26R int, CELL26W int,
	CELL30DIRT int,
	CELL31B int, CELL31R int, CELL31W int,
	CELL32B int, CELL32R int, CELL32W int,
	CELL33B int, CELL33R int, CELL33W int,
	CELL34B int, CELL34R int, CELL34W int,
	CELL35B int, CELL35R int, CELL35W int,
	CELL36B int, CELL36R int, CELL36W int,
	CELL40DIRT int,
	CELL41B int, CELL41R int, CELL41W int,
	CELL42B int, CELL42R int, CELL42W int,
	CELL43B int, CELL43R int, CELL43W int,
	CELL44B int, CELL44R int, CELL44W int,
	CELL45B int, CELL45R int, CELL45W int,
	CELL46B int, CELL46R int, CELL46W int,
	CELL50DIRT int,
	CELL51B int, CELL51R int, CELL51W int,
	CELL52B int, CELL52R int, CELL52W int,
	CELL53B int, CELL53R int, CELL53W int,
	CELL54B int, CELL54R int, CELL54W int,
	CELL55B int, CELL55R int, CELL55W int,
	CELL56B int, CELL56R int, CELL56W int,
	CELL60DIRT int,
	CELL61B int, CELL61R int, CELL61W int,
	CELL62B int, CELL62R int, CELL62W int,
	CELL63B int, CELL63R int, CELL63W int,
	CELL64B int, CELL64R int, CELL64W int,
	CELL65B int, CELL65R int, CELL65W int,
	CELL66B int, CELL66R int, CELL66W int,
	CELL70DIRT int,
	CELL71B int, CELL71R int, CELL71W int,
	CELL72B int, CELL72R int, CELL72W int,
	CELL73B int, CELL73R int, CELL73W int,
	CELL74B int, CELL74R int, CELL74W int,
	CELL75B int, CELL75R int, CELL75W int,
	CELL76B int, CELL76R int, CELL76W int
);
insert into states_parsed 
(select 
	game,
    m.match_id,
    s.step_number,
	IF(LOCATE('CONTROL RED',state) > 0, 1, -1) as   CONTROLRED,
	IF(LOCATE('CONTROL WHITE',state) > 0, 1, -1) as CONTROLWHITE,
	IF(LOCATE('CELL 1 0 DIRT',state) > 0, 1, -1) as CELL10DIRT,
	IF(LOCATE('CELL 1 1 B',state) > 0, 1, -1) as 	 CELL11B,
	IF(LOCATE('CELL 1 1 R',state) > 0, 1, -1) as 	 CELL11R,
	IF(LOCATE('CELL 1 1 W',state) > 0, 1, -1) as 	 CELL11W,
	IF(LOCATE('CELL 1 2 B',state) > 0, 1, -1) as 	 CELL12B,
	IF(LOCATE('CELL 1 2 R',state) > 0, 1, -1) as 	 CELL12R,
	IF(LOCATE('CELL 1 2 W',state) > 0, 1, -1) as 	 CELL12W,
	IF(LOCATE('CELL 1 3 B',state) > 0, 1, -1) as 	 CELL13B,
	IF(LOCATE('CELL 1 3 R',state) > 0, 1, -1) as 	 CELL13R,
	IF(LOCATE('CELL 1 3 W',state) > 0, 1, -1) as 	 CELL13W,
	IF(LOCATE('CELL 1 4 B',state) > 0, 1, -1) as 	 CELL14B,
	IF(LOCATE('CELL 1 4 R',state) > 0, 1, -1) as 	 CELL14R,
	IF(LOCATE('CELL 1 4 W',state) > 0, 1, -1) as 	 CELL14W,
	IF(LOCATE('CELL 1 5 B',state) > 0, 1, -1) as 	 CELL15B,
	IF(LOCATE('CELL 1 5 R',state) > 0, 1, -1) as 	 CELL15R,
	IF(LOCATE('CELL 1 5 W',state) > 0, 1, -1) as 	 CELL15W,
	IF(LOCATE('CELL 1 6 B',state) > 0, 1, -1) as 	 CELL16B,
	IF(LOCATE('CELL 1 6 R',state) > 0, 1, -1) as 	 CELL16R,
	IF(LOCATE('CELL 1 6 W',state) > 0, 1, -1) as 	 CELL16W,
	IF(LOCATE('CELL 2 0 DIRT',state) > 0, 1, -1) as CELL20DIRT,
	IF(LOCATE('CELL 2 1 B',state) > 0, 1, -1) as    CELL21B,
	IF(LOCATE('CELL 2 1 R',state) > 0, 1, -1) as    CELL21R,
	IF(LOCATE('CELL 2 1 W',state) > 0, 1, -1) as    CELL21W,
	IF(LOCATE('CELL 2 2 B',state) > 0, 1, -1) as    CELL22B,
	IF(LOCATE('CELL 2 2 R',state) > 0, 1, -1) as    CELL22R,
	IF(LOCATE('CELL 2 2 W',state) > 0, 1, -1) as    CELL22W,
	IF(LOCATE('CELL 2 3 B',state) > 0, 1, -1) as    CELL23B,
	IF(LOCATE('CELL 2 3 R',state) > 0, 1, -1) as    CELL23R,
	IF(LOCATE('CELL 2 3 W',state) > 0, 1, -1) as    CELL23W,
	IF(LOCATE('CELL 2 4 B',state) > 0, 1, -1) as    CELL24B,
	IF(LOCATE('CELL 2 4 R',state) > 0, 1, -1) as    CELL24R,
	IF(LOCATE('CELL 2 4 W',state) > 0, 1, -1) as    CELL24W,
	IF(LOCATE('CELL 2 5 B',state) > 0, 1, -1) as    CELL25B,
	IF(LOCATE('CELL 2 5 R',state) > 0, 1, -1) as    CELL25R,
	IF(LOCATE('CELL 2 5 W',state) > 0, 1, -1) as    CELL25W,
	IF(LOCATE('CELL 2 6 B',state) > 0, 1, -1) as    CELL26B,
	IF(LOCATE('CELL 2 6 R',state) > 0, 1, -1) as    CELL26R,
	IF(LOCATE('CELL 2 6 W',state) > 0, 1, -1) as    CELL26W,
	IF(LOCATE('CELL 3 0 DIRT',state) > 0, 1, -1) as CELL30DIRT,
	IF(LOCATE('CELL 3 1 B',state) > 0, 1, -1) as    CELL31B,
	IF(LOCATE('CELL 3 1 R',state) > 0, 1, -1) as    CELL31R,
	IF(LOCATE('CELL 3 1 W',state) > 0, 1, -1) as    CELL31W,
	IF(LOCATE('CELL 3 2 B',state) > 0, 1, -1) as    CELL32B,
	IF(LOCATE('CELL 3 2 R',state) > 0, 1, -1) as    CELL32R,
	IF(LOCATE('CELL 3 2 W',state) > 0, 1, -1) as    CELL32W,
	IF(LOCATE('CELL 3 3 B',state) > 0, 1, -1) as    CELL33B,
	IF(LOCATE('CELL 3 3 R',state) > 0, 1, -1) as    CELL33R,
	IF(LOCATE('CELL 3 3 W',state) > 0, 1, -1) as    CELL33W,
	IF(LOCATE('CELL 3 4 B',state) > 0, 1, -1) as    CELL34B,
	IF(LOCATE('CELL 3 4 R',state) > 0, 1, -1) as    CELL34R,
	IF(LOCATE('CELL 3 4 W',state) > 0, 1, -1) as    CELL34W,
	IF(LOCATE('CELL 3 5 B',state) > 0, 1, -1) as    CELL35B,
	IF(LOCATE('CELL 3 5 R',state) > 0, 1, -1) as    CELL35R,
	IF(LOCATE('CELL 3 5 W',state) > 0, 1, -1) as    CELL35W,
	IF(LOCATE('CELL 3 6 B',state) > 0, 1, -1) as    CELL36B,
	IF(LOCATE('CELL 3 6 R',state) > 0, 1, -1) as    CELL36R,
	IF(LOCATE('CELL 3 6 W',state) > 0, 1, -1) as    CELL36W,
	IF(LOCATE('CELL 4 0 DIRT',state) > 0, 1, -1) as CELL40DIRT,
	IF(LOCATE('CELL 4 1 B',state) > 0, 1, -1) as    CELL41B,
	IF(LOCATE('CELL 4 1 R',state) > 0, 1, -1) as    CELL41R,
	IF(LOCATE('CELL 4 1 W',state) > 0, 1, -1) as    CELL41W,
	IF(LOCATE('CELL 4 2 B',state) > 0, 1, -1) as    CELL42B,
	IF(LOCATE('CELL 4 2 R',state) > 0, 1, -1) as    CELL42R,
	IF(LOCATE('CELL 4 2 W',state) > 0, 1, -1) as    CELL42W,
	IF(LOCATE('CELL 4 3 B',state) > 0, 1, -1) as    CELL43B,
	IF(LOCATE('CELL 4 3 R',state) > 0, 1, -1) as    CELL43R,
	IF(LOCATE('CELL 4 3 W',state) > 0, 1, -1) as    CELL43W,
	IF(LOCATE('CELL 4 4 B',state) > 0, 1, -1) as    CELL44B,
	IF(LOCATE('CELL 4 4 R',state) > 0, 1, -1) as    CELL44R,
	IF(LOCATE('CELL 4 4 W',state) > 0, 1, -1) as    CELL44W,
	IF(LOCATE('CELL 4 5 B',state) > 0, 1, -1) as    CELL45B,
	IF(LOCATE('CELL 4 5 R',state) > 0, 1, -1) as    CELL45R,
	IF(LOCATE('CELL 4 5 W',state) > 0, 1, -1) as    CELL45W,
	IF(LOCATE('CELL 4 6 B',state) > 0, 1, -1) as    CELL46B,
	IF(LOCATE('CELL 4 6 R',state) > 0, 1, -1) as    CELL46R,
	IF(LOCATE('CELL 4 6 W',state) > 0, 1, -1) as    CELL46W,
	IF(LOCATE('CELL 5 0 DIRT',state) > 0, 1, -1) as CELL50DIRT,
	IF(LOCATE('CELL 5 1 B',state) > 0, 1, -1) as 	 CELL51B,
	IF(LOCATE('CELL 5 1 R',state) > 0, 1, -1) as 	 CELL51R,
	IF(LOCATE('CELL 5 1 W',state) > 0, 1, -1) as 	 CELL51W,
	IF(LOCATE('CELL 5 2 B',state) > 0, 1, -1) as 	 CELL52B,
	IF(LOCATE('CELL 5 2 R',state) > 0, 1, -1) as 	 CELL52R,
	IF(LOCATE('CELL 5 2 W',state) > 0, 1, -1) as 	 CELL52W,
	IF(LOCATE('CELL 5 3 B',state) > 0, 1, -1) as 	 CELL53B,
	IF(LOCATE('CELL 5 3 R',state) > 0, 1, -1) as 	 CELL53R,
	IF(LOCATE('CELL 5 3 W',state) > 0, 1, -1) as 	 CELL53W,
	IF(LOCATE('CELL 5 4 B',state) > 0, 1, -1) as 	 CELL54B,
	IF(LOCATE('CELL 5 4 R',state) > 0, 1, -1) as 	 CELL54R,
	IF(LOCATE('CELL 5 4 W',state) > 0, 1, -1) as 	 CELL54W,
	IF(LOCATE('CELL 5 5 B',state) > 0, 1, -1) as 	 CELL55B,
	IF(LOCATE('CELL 5 5 R',state) > 0, 1, -1) as 	 CELL55R,
	IF(LOCATE('CELL 5 5 W',state) > 0, 1, -1) as 	 CELL55W,
	IF(LOCATE('CELL 5 6 B',state) > 0, 1, -1) as 	 CELL56B,
	IF(LOCATE('CELL 5 6 R',state) > 0, 1, -1) as 	 CELL56R,
	IF(LOCATE('CELL 5 6 W',state) > 0, 1, -1) as 	 CELL56W,
	IF(LOCATE('CELL 6 0 DIRT',state) > 0, 1, -1) as CELL60DIRT,
	IF(LOCATE('CELL 6 1 B',state) > 0, 1, -1) as    CELL61B,
	IF(LOCATE('CELL 6 1 R',state) > 0, 1, -1) as    CELL61R,
	IF(LOCATE('CELL 6 1 W',state) > 0, 1, -1) as    CELL61W,
	IF(LOCATE('CELL 6 2 B',state) > 0, 1, -1) as    CELL62B,
	IF(LOCATE('CELL 6 2 R',state) > 0, 1, -1) as    CELL62R,
	IF(LOCATE('CELL 6 2 W',state) > 0, 1, -1) as    CELL62W,
	IF(LOCATE('CELL 6 3 B',state) > 0, 1, -1) as    CELL63B,
	IF(LOCATE('CELL 6 3 R',state) > 0, 1, -1) as    CELL63R,
	IF(LOCATE('CELL 6 3 W',state) > 0, 1, -1) as    CELL63W,
	IF(LOCATE('CELL 6 4 B',state) > 0, 1, -1) as    CELL64B,
	IF(LOCATE('CELL 6 4 R',state) > 0, 1, -1) as    CELL64R,
	IF(LOCATE('CELL 6 4 W',state) > 0, 1, -1) as    CELL64W,
	IF(LOCATE('CELL 6 5 B',state) > 0, 1, -1) as    CELL65B,
	IF(LOCATE('CELL 6 5 R',state) > 0, 1, -1) as    CELL65R,
	IF(LOCATE('CELL 6 5 W',state) > 0, 1, -1) as    CELL65W,
	IF(LOCATE('CELL 6 6 B',state) > 0, 1, -1) as    CELL66B,
	IF(LOCATE('CELL 6 6 R',state) > 0, 1, -1) as    CELL66R,
	IF(LOCATE('CELL 6 6 W',state) > 0, 1, -1) as    CELL66W,
	IF(LOCATE('CELL 7 0 DIRT',state) > 0, 1, -1) as CELL70DIRT,
	IF(LOCATE('CELL 7 1 B',state) > 0, 1, -1) as    CELL71B,
	IF(LOCATE('CELL 7 1 R',state) > 0, 1, -1) as    CELL71R,
	IF(LOCATE('CELL 7 1 W',state) > 0, 1, -1) as    CELL71W,
	IF(LOCATE('CELL 7 2 B',state) > 0, 1, -1) as    CELL72B,
	IF(LOCATE('CELL 7 2 R',state) > 0, 1, -1) as    CELL72R,
	IF(LOCATE('CELL 7 2 W',state) > 0, 1, -1) as    CELL72W,
	IF(LOCATE('CELL 7 3 B',state) > 0, 1, -1) as    CELL73B,
	IF(LOCATE('CELL 7 3 R',state) > 0, 1, -1) as    CELL73R,
	IF(LOCATE('CELL 7 3 W',state) > 0, 1, -1) as    CELL73W,
	IF(LOCATE('CELL 7 4 B',state) > 0, 1, -1) as    CELL74B,
	IF(LOCATE('CELL 7 4 R',state) > 0, 1, -1) as    CELL74R,
	IF(LOCATE('CELL 7 4 W',state) > 0, 1, -1) as    CELL74W,
	IF(LOCATE('CELL 7 5 B',state) > 0, 1, -1) as    CELL75B,
	IF(LOCATE('CELL 7 5 R',state) > 0, 1, -1) as    CELL75R,
	IF(LOCATE('CELL 7 5 W',state) > 0, 1, -1) as    CELL75W,
	IF(LOCATE('CELL 7 6 B',state) > 0, 1, -1) as    CELL76B,
	IF(LOCATE('CELL 7 6 R',state) > 0, 1, -1) as    CELL76R,
	IF(LOCATE('CELL 7 6 W',state) > 0, 1, -1) as    CELL76W
	FROM states s
	INNER JOIN matches m ON m.match_id = s.match_id
	WHERE
		m.game = 'connect4'
);
